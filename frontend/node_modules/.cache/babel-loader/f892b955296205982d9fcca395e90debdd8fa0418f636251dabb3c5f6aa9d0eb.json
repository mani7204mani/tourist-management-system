{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rocky\\\\OneDrive\\\\Desktop\\\\tms-project\\\\frontend\\\\src\\\\PackagesPage.js\",\n  _s = $RefreshSig$();\n// frontend/src/PackagesPage.js - FIXED WITH PAYMENT MODE\n\nimport React, { useState, useEffect } from 'react';\nimport PackageFilter from './PackageFilter';\nimport PackageCard from './PackageCard';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction PackagesPage() {\n  _s();\n  const [filteredPackages, setFilteredPackages] = useState([]);\n  const [activeFilters, setActiveFilters] = useState({});\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n  const handleBookTour = packageData => {\n    const persons = activeFilters.persons || 1;\n    const payment = activeFilters.payment || 'UPI';\n\n    // FIX 1: Use backticks (`) for template literals to correctly build the navigation path.\n    navigate(`/book/${packageData.name.replace(/\\s+/g, '-')}`, {\n      state: {\n        package: packageData,\n        persons: persons,\n        totalPrice: packageData.price * persons,\n        payment: payment,\n        // Pass payment mode explicitly\n        activeFilters: activeFilters\n      }\n    });\n  };\n  const fetchPackages = async filters => {\n    setLoading(true);\n\n    // Safely handle filter values with defaults\n    const safePlaces = filters.places || [];\n    const safeCountries = filters.countries || [];\n    setActiveFilters(filters);\n\n    // Build query parameters\n    const query = new URLSearchParams({\n      places: safePlaces.join(','),\n      countries: safeCountries.join(',')\n    }).toString();\n    try {\n      // FIX 2: Use backticks (`) for template literals to correctly build the fetch URL.\n      const response = await fetch(`/api/packages/filter?${query}`);\n      if (response.ok) {\n        const data = await response.json();\n        setFilteredPackages(data);\n        console.log('Filtered packages:', data);\n      } else {\n        console.error('Failed to fetch packages');\n        setFilteredPackages([]);\n      }\n    } catch (error) {\n      console.error(\"Error fetching packages:\", error);\n      setFilteredPackages([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Initial load: fetch all packages\n  useEffect(() => {\n    fetchPackages({\n      places: [],\n      countries: [],\n      persons: 1,\n      payment: \"UPI\"\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"packages-page-container dashboard-content\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Find Your Dream Package\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(PackageFilter, {\n      onFilter: fetchPackages\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"package-results-grid\",\n      children: loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Searching for packages...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 21\n      }, this) : filteredPackages.length > 0 ? filteredPackages.map(pkg => /*#__PURE__*/_jsxDEV(PackageCard, {\n        packageData: pkg,\n        onBookClick: handleBookTour\n      }, pkg.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 25\n      }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No packages found matching your criteria. Try adjusting your filters.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 9\n  }, this);\n}\n_s(PackagesPage, \"3r/QP03KHiU6895Ulma5O978Ycc=\", false, function () {\n  return [useNavigate];\n});\n_c = PackagesPage;\nexport default PackagesPage;\nvar _c;\n$RefreshReg$(_c, \"PackagesPage\");","map":{"version":3,"names":["React","useState","useEffect","PackageFilter","PackageCard","useNavigate","jsxDEV","_jsxDEV","PackagesPage","_s","filteredPackages","setFilteredPackages","activeFilters","setActiveFilters","loading","setLoading","navigate","handleBookTour","packageData","persons","payment","name","replace","state","package","totalPrice","price","fetchPackages","filters","safePlaces","places","safeCountries","countries","query","URLSearchParams","join","toString","response","fetch","ok","data","json","console","log","error","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onFilter","length","map","pkg","onBookClick","id","_c","$RefreshReg$"],"sources":["C:/Users/rocky/OneDrive/Desktop/tms-project/frontend/src/PackagesPage.js"],"sourcesContent":["// frontend/src/PackagesPage.js - FIXED WITH PAYMENT MODE\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport PackageFilter from './PackageFilter';\r\nimport PackageCard from './PackageCard';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nfunction PackagesPage() {\r\n    const [filteredPackages, setFilteredPackages] = useState([]);\r\n    const [activeFilters, setActiveFilters] = useState({});\r\n    const [loading, setLoading] = useState(false);\r\n    const navigate = useNavigate();\r\n\r\n    const handleBookTour = (packageData) => {\r\n        const persons = activeFilters.persons || 1;\r\n        const payment = activeFilters.payment || 'UPI';\r\n        \r\n        // FIX 1: Use backticks (`) for template literals to correctly build the navigation path.\r\n        navigate(`/book/${packageData.name.replace(/\\s+/g, '-')}`, {\r\n            state: {\r\n                package: packageData,\r\n                persons: persons,\r\n                totalPrice: packageData.price * persons,\r\n                payment: payment,  // Pass payment mode explicitly\r\n                activeFilters: activeFilters\r\n            }\r\n        });\r\n    };\r\n\r\n    const fetchPackages = async (filters) => {\r\n        setLoading(true);\r\n        \r\n        // Safely handle filter values with defaults\r\n        const safePlaces = filters.places || [];\r\n        const safeCountries = filters.countries || [];\r\n        \r\n        setActiveFilters(filters);\r\n\r\n        // Build query parameters\r\n        const query = new URLSearchParams({\r\n            places: safePlaces.join(','),\r\n            countries: safeCountries.join(','),\r\n        }).toString();\r\n\r\n        try {\r\n            // FIX 2: Use backticks (`) for template literals to correctly build the fetch URL.\r\n            const response = await fetch(`/api/packages/filter?${query}`);\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                setFilteredPackages(data);\r\n                console.log('Filtered packages:', data);\r\n            } else {\r\n                console.error('Failed to fetch packages');\r\n                setFilteredPackages([]);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error fetching packages:\", error);\r\n            setFilteredPackages([]);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n    \r\n    // Initial load: fetch all packages\r\n    useEffect(() => {\r\n        fetchPackages({\r\n            places: [],\r\n            countries: [],\r\n            persons: 1,\r\n            payment: \"UPI\"\r\n        });\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"packages-page-container dashboard-content\">\r\n            <h1>Find Your Dream Package</h1>\r\n            \r\n            {/* Filter Component */}\r\n            <PackageFilter onFilter={fetchPackages} />\r\n            \r\n            {/* Results */}\r\n            <div className=\"package-results-grid\">\r\n                {loading ? (\r\n                    <p>Searching for packages...</p>\r\n                ) : filteredPackages.length > 0 ? (\r\n                    filteredPackages.map(pkg => (\r\n                        <PackageCard\r\n                            key={pkg.id}\r\n                            packageData={pkg}\r\n                            onBookClick={handleBookTour}\r\n                        />\r\n                    ))\r\n                ) : (\r\n                    <p>No packages found matching your criteria. Try adjusting your filters.</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PackagesPage;"],"mappings":";;AAAA;;AAEA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,aAAa,MAAM,iBAAiB;AAC3C,OAAOC,WAAW,MAAM,eAAe;AACvC,SAASC,WAAW,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/C,SAASC,YAAYA,CAAA,EAAG;EAAAC,EAAA;EACpB,MAAM,CAACC,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGV,QAAQ,CAAC,EAAE,CAAC;EAC5D,MAAM,CAACW,aAAa,EAAEC,gBAAgB,CAAC,GAAGZ,QAAQ,CAAC,CAAC,CAAC,CAAC;EACtD,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAMe,QAAQ,GAAGX,WAAW,CAAC,CAAC;EAE9B,MAAMY,cAAc,GAAIC,WAAW,IAAK;IACpC,MAAMC,OAAO,GAAGP,aAAa,CAACO,OAAO,IAAI,CAAC;IAC1C,MAAMC,OAAO,GAAGR,aAAa,CAACQ,OAAO,IAAI,KAAK;;IAE9C;IACAJ,QAAQ,CAAC,SAASE,WAAW,CAACG,IAAI,CAACC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE,EAAE;MACvDC,KAAK,EAAE;QACHC,OAAO,EAAEN,WAAW;QACpBC,OAAO,EAAEA,OAAO;QAChBM,UAAU,EAAEP,WAAW,CAACQ,KAAK,GAAGP,OAAO;QACvCC,OAAO,EAAEA,OAAO;QAAG;QACnBR,aAAa,EAAEA;MACnB;IACJ,CAAC,CAAC;EACN,CAAC;EAED,MAAMe,aAAa,GAAG,MAAOC,OAAO,IAAK;IACrCb,UAAU,CAAC,IAAI,CAAC;;IAEhB;IACA,MAAMc,UAAU,GAAGD,OAAO,CAACE,MAAM,IAAI,EAAE;IACvC,MAAMC,aAAa,GAAGH,OAAO,CAACI,SAAS,IAAI,EAAE;IAE7CnB,gBAAgB,CAACe,OAAO,CAAC;;IAEzB;IACA,MAAMK,KAAK,GAAG,IAAIC,eAAe,CAAC;MAC9BJ,MAAM,EAAED,UAAU,CAACM,IAAI,CAAC,GAAG,CAAC;MAC5BH,SAAS,EAAED,aAAa,CAACI,IAAI,CAAC,GAAG;IACrC,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;IAEb,IAAI;MACA;MACA,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,wBAAwBL,KAAK,EAAE,CAAC;MAC7D,IAAII,QAAQ,CAACE,EAAE,EAAE;QACb,MAAMC,IAAI,GAAG,MAAMH,QAAQ,CAACI,IAAI,CAAC,CAAC;QAClC9B,mBAAmB,CAAC6B,IAAI,CAAC;QACzBE,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEH,IAAI,CAAC;MAC3C,CAAC,MAAM;QACHE,OAAO,CAACE,KAAK,CAAC,0BAA0B,CAAC;QACzCjC,mBAAmB,CAAC,EAAE,CAAC;MAC3B;IACJ,CAAC,CAAC,OAAOiC,KAAK,EAAE;MACZF,OAAO,CAACE,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAChDjC,mBAAmB,CAAC,EAAE,CAAC;IAC3B,CAAC,SAAS;MACNI,UAAU,CAAC,KAAK,CAAC;IACrB;EACJ,CAAC;;EAED;EACAb,SAAS,CAAC,MAAM;IACZyB,aAAa,CAAC;MACVG,MAAM,EAAE,EAAE;MACVE,SAAS,EAAE,EAAE;MACbb,OAAO,EAAE,CAAC;MACVC,OAAO,EAAE;IACb,CAAC,CAAC;EACN,CAAC,EAAE,EAAE,CAAC;EAEN,oBACIb,OAAA;IAAKsC,SAAS,EAAC,2CAA2C;IAAAC,QAAA,gBACtDvC,OAAA;MAAAuC,QAAA,EAAI;IAAuB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAGhC3C,OAAA,CAACJ,aAAa;MAACgD,QAAQ,EAAExB;IAAc;MAAAoB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAG1C3C,OAAA;MAAKsC,SAAS,EAAC,sBAAsB;MAAAC,QAAA,EAChChC,OAAO,gBACJP,OAAA;QAAAuC,QAAA,EAAG;MAAyB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC,GAChCxC,gBAAgB,CAAC0C,MAAM,GAAG,CAAC,GAC3B1C,gBAAgB,CAAC2C,GAAG,CAACC,GAAG,iBACpB/C,OAAA,CAACH,WAAW;QAERc,WAAW,EAAEoC,GAAI;QACjBC,WAAW,EAAEtC;MAAe,GAFvBqC,GAAG,CAACE,EAAE;QAAAT,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAGd,CACJ,CAAC,gBAEF3C,OAAA;QAAAuC,QAAA,EAAG;MAAqE;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG;IAC9E;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEd;AAACzC,EAAA,CA3FQD,YAAY;EAAA,QAIAH,WAAW;AAAA;AAAAoD,EAAA,GAJvBjD,YAAY;AA6FrB,eAAeA,YAAY;AAAC,IAAAiD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}